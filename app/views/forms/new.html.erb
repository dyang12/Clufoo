<div class="inner-body">
	<%= render :partial => "layouts/errors" %>
	
	<div>
		<div class="form-toolbar">
			<ul id="myTab" class="nav nav-tabs">
				<li class="add-field-tab active">
					<a href="#add-field" data-toggle="tab">Add a Field</a>
				</li>
				<li class="edit-field-tab">
					<a href="#edit-field" data-toggle="tab">Field Settings</a>
				</li>
				<li class="edit-form-tab">
					<a href="#edit-form" data-toggle="tab">Form Settings</a>
				</li>
			</ul>
			<div id="myTabContent" class="tab-content">
				<div id="add-field" class="tab-pane fade active in">
					<div class="tab-form">
						<h4>Standard Fields</h4>
						<button id="text-field-btn" class="btn btn-list" type="button">Single Line Text</button>
						<button id="text-area-btn" class="btn btn-list" type="button">Paragraph Text</button>
						<br>
						<br>
						<button id="checkbox-btn" class="btn btn-list" type="button">Checkbox</button>
						<button id="dropdown-btn" class="btn btn-list" type="button">Dropdown</button>
						<br>
						<br>
						<button id="select-btn" class="btn btn-list" type="button">Multiple Choice</button>
					</div>
				</div>
				<div id="edit-field" class="tab-pane fade">
					<div class="tab-form">
						<!-- append field forms onto tab-form -->
					</div>
				</div>
				<div id="edit-form" class="tab-pane fade">
						
				</div>
			</div>
		</div>
		<div class="new-form">
			<div id="form">
				<h3 id="form-title">Untitled Form</h3>
				<p id="form-description">Create a new form!</p>
			</div>
			
				<ul id="fields"></ul>
			
		</div>
		<div id="create-form">
			<button id="create-form-btn" class="btn btn-primary pull-right" type="submit">Make Form</button>
			<br>
		</div>
	</div>
</div>

<script>
	$(document).ready(function() {
		var numFields = 0;
		var currClick = null;
		
		$("#text-field-btn").on("click", function (event) {
			var textField = JST["text_field"];
			$("#fields").append("<li class=\"field-" + numFields + "\">" + textField() + "</li>");
			numFields++;
		});
		
		$("#text-area-btn").on("click", function (event) {
			var textArea = JST["text_area"];
			$("#fields").append("<li class=\"field-" + numFields + "\">" + textArea() + "</li>");
			numFields++;
		});
		
		$("#checkbox-btn").on("click", function (event) {
			var checkbox = JST["checkbox"];
			$("#fields").append("<li class=\"field-" + numFields + "\">" + checkbox() + "</li>");
			numFields++;
		});
		
		$("#dropdown-btn").on("click", function (event) {
			var dropdown = JST["dropdown"];
			$("#fields").append("<li class=\"field-" + numFields + "\">" + dropdown() + "</li>");
			numFields++;
		});
		
		$("#select-btn").on("click", function (event) {
			var multipleChoice = JST["select"];
			$("#fields").append("<li class=\"field-" + numFields + "\">" + multipleChoice() + "</li>");
			numFields++;
		});
		
		$("ul#fields").on("click", "li", function (event) {
			if(currClick) {
				currClick.toggleClass("clicked");
			}
			
			currClick = $(event.currentTarget)
			currClick.toggleClass("clicked");
			
			$("li.active").toggleClass("active");
			$("li.edit-field-tab").toggleClass("active");
			
			$("div.active").toggleClass("active in");
			$("div#edit-field").toggleClass("active in");
		});
		
		$("#form").on("click", function (event) {
			if(currClick) {
				currClick.toggleClass("clicked");
			}
			
			currClick = $(event.currentTarget)
			currClick.toggleClass("clicked");
			
			$("li.active").toggleClass("active");
			$("li.edit-form-tab").toggleClass("active");
			
			$("div.active").toggleClass("active in");
			$("div#edit-form").toggleClass("active in");
		});
		
		$("#myTab .add-field-tab").on("click", function(event) {
			if(currClick) {
				currClick.toggleClass("clicked");
				currClick = null
			}
		});
		
		$("#myTab .edit-form-tab").on("click", function(event) {
			var title = $('#form-title').text();
			var description = $('#form-description').text();
			var form = {
				title: title,
				description: description
			};
			
			if(currClick) {
				currClick.toggleClass("clicked");
				currClick = null
			}
			
			currClick = $("#form");
			currClick.toggleClass("clicked");
			
			var template = JST["edit_form"];
			var editForm = template({
				form: form
			})
			
			
			$("#edit-form").html(editForm);
		});
		
		$("#myTab .edit-field-tab").on("click", function(event) {
			if(currClick) {
				currClick.toggleClass("clicked");
				currClick = null
			}
			
			if ($("ul#fields").html() == "") {
				var textField = JST["text_field"];
				$("#fields").append("<li class=\"field-" + numFields + "\">" + textField() + "</li>");
				numFields++;
			}
			
			currClick = $("ul#fields li.field-0");
			currClick.toggleClass("clicked");
		});
		
		$("#create-form-btn").on("click", function(event) {
			var form = {};
			var fields = {};
			
			formData = $("#form").html();
			
			for(var i = 0; i < numFields; i++) {
				console.log(fieldsData = $(".field-" + i).html());
			}
			
			debugger
		});
	});
</script>